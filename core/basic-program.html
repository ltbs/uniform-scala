<html><head><title>uniform-scala: Writing a journey</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Luke Tebbs" /><meta name="description" content="Purely functional user-interaction" /><meta name="og:image" content="/uniform-scala/img/poster.png" /><meta name="image" property="og:image" content="/uniform-scala/img/poster.png" /><meta name="og:title" content="uniform-scala: Writing a journey" /><meta name="title" property="og:title" content="uniform-scala: Writing a journey" /><meta name="og:site_name" content="uniform-scala" /><meta name="og:url" content="https://ltbs.github.io/uniform-scala/" /><meta name="og:type" content="website" /><meta name="og:description" content="Purely functional user-interaction" /><link rel="icon" type="image/png" href="/uniform-scala/img/favicon.png" /><meta name="twitter:title" content="uniform-scala: Writing a journey" /><meta name="twitter:image" content="/uniform-scala/img/poster.png" /><meta name="twitter:description" content="Purely functional user-interaction" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/uniform-scala/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/uniform-scala/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/uniform-scala/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/uniform-scala/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/uniform-scala/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/uniform-scala/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/uniform-scala/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/uniform-scala/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/uniform-scala/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/uniform-scala/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/uniform-scala/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/uniform-scala/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/uniform-scala/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/uniform-scala/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/uniform-scala/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/uniform-scala/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/uniform-scala/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/uniform-scala/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/uniform-scala/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/uniform-scala/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/uniform-scala/highlight/styles/color-brewer.css" /><link rel="stylesheet" href="/uniform-scala/css/style.css" /><link rel="stylesheet" href="/uniform-scala/css/palette.css" /><link rel="stylesheet" href="/uniform-scala/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/uniform-scala/" class="brand"><div class="brand-wrapper"><span>uniform-scala</span></div></a></li> <li><a href="/uniform-scala/index.html" class="">Home</a></li> <li><a href="/uniform-scala/setup.html" class="">Setup</a></li> <li><a href="/uniform-scala/core/basic-program.html" class=" active ">Writing a journey</a> <ul class="sub_section"> <li><a href="/uniform-scala/core/tells.html" class="">Telling</a></li> <li><a href="/uniform-scala/core/asks.html" class="">Asking</a></li> <li><a href="/uniform-scala/core/interacts.html" class="">Interacting</a></li> <li><a href="/uniform-scala/core/validation.html" class="">Validation</a></li> <li><a href="/uniform-scala/core/branching.html" class="">Branching</a></li> <li><a href="/uniform-scala/core/remote-calls.html" class="">Remote Calls</a></li></ul></li> <li><a href="/uniform-scala/play/index.html" class="">Play Framework Interpreter</a> <ul class="sub_section"> <li><a href="/uniform-scala/play/controllers.html" class="">Controllers</a></li> <li><a href="/uniform-scala/play/web-monad.html" class="">WebMonad</a></li> <li><a href="/uniform-scala/play/internationalisation.html" class="">Internationalisation</a></li> <li><a href="/uniform-scala/play/listing-pages.html" class="">Listing Pages</a></li> <li><a href="/uniform-scala/play/remote-calls.html" class="">Memoisation</a></li></ul></li> <li><a href="/uniform-scala/interpreters.html" class="">Other Interpreters</a> <ul class="sub_section"> <li><a href="/uniform-scala/other/interpreter-cli.html" class="">CLI Interpreter</a></li> <li><a href="/uniform-scala/other/interpreter-logic-table.html" class="">Logic Table Interpreter</a></li> <li><a href="/uniform-scala/interpreter-static-site.html" class="">Static Site interpreter</a></li> <li><a href="/uniform-scala/interpreter-selenium.html" class="">Selenium Interpreter</a></li></ul></li> <li><a href="/uniform-scala/core/advanced.html" class="">Advanced Options</a> <ul class="sub_section"> <li><a href="/uniform-scala/core/writing-interpreters.html" class="">Writing Interpreters</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('uniform-scala Purely functional user-interaction');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('uniform-scala Purely functional user-interaction');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="ltbs" data-github-repo="uniform-scala"><div class="content-wrapper"><section><h1 id="writing-a-basic-journey">Writing a basic journey</h1>

<p>To get our feet wet we’re going to start with a simple user journey that
does a few things - first it will ask the user for their date of
birth, secondly it will calculate the number of days the user has been
alive and finally it will return their date of birth as a string.</p>

<h2 id="imports">Imports</h2>

<p>You will need to import the core uniform library, and you will need
cats. You do not need to import any interpreters when merely defining the journey.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">ltbs.uniform._</span>
<span class="k">import</span> <span class="nn">cats.implicits._</span>
</code></pre></div></div>

<p>We will also be using higher-kinded types, here we have enabled this as an import -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scala.language.higherKinds</span>
</code></pre></div></div>

<p>We’re going to use the old <code class="highlighter-rouge">java.time.LocalDate</code> in our program
too along with some code for formatting. This is specific to our
example here and not likely needed for your project.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">java.time._</span><span class="o">,</span> <span class="n">format</span><span class="o">.</span><span class="k">_</span>
</code></pre></div></div>

<h2 id="type-declarations">Type declarations</h2>

<p>Next we have the type declarations for the ‘tells’ -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="kt">TellTypes</span> <span class="o">=</span> <span class="nc">Long</span> <span class="o">::</span> <span class="nc">NilTypes</span>
</code></pre></div></div>
<p>In this instance we want to be able to present the user with <code class="highlighter-rouge">Long</code>
values. This means that any interpreter running our journey must know
how to present an <code class="highlighter-rouge">Long</code> to the user (for example a web-based
interpreter would probably need to know how to render this datatype
into HTML). We’ll use this to tell the user the number of days they
have been alive for.</p>

<p>If our journey needed to be able to present <code class="highlighter-rouge">Address</code>es, <code class="highlighter-rouge">Name</code>s and
lists of <code class="highlighter-rouge">Colour</code>s to the user we would assign <code class="highlighter-rouge">TellTypes</code> to
<code class="highlighter-rouge">Address :: Name :: List[Colour] :: NilTypes</code>.</p>

<p>Sometimes we don’t need to present anything back to the user in which
case we would just use <code class="highlighter-rouge">NilTypes</code> on its own.</p>

<p>Next we need a similar type declaration for the ‘asks’ -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="kt">AskTypes</span> <span class="o">=</span> <span class="nc">LocalDate</span> <span class="o">::</span> <span class="nc">NilTypes</span>
</code></pre></div></div>

<p>Here we are saying that an interpreter must know how to prompt the
user to enter a <code class="highlighter-rouge">java.time.LocalDate</code>. This will be used to prompt the
user for their date of birth.</p>

<h2 id="journey-definition">Journey definition</h2>

<p>Now we can create our main journey body.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="n">dateOfBirth</span><span class="o">[</span><span class="kt">F</span><span class="o">[</span><span class="k">_</span><span class="o">]</span> <span class="kt">:</span> <span class="kt">cats.Monad</span><span class="o">](</span>
  <span class="n">interpreter</span><span class="k">:</span> <span class="kt">Language</span><span class="o">[</span><span class="kt">F</span>, <span class="kt">TellTypes</span>, <span class="kt">AskTypes</span><span class="o">]</span>
<span class="o">)</span><span class="k">:</span> <span class="kt">F</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">import</span> <span class="nn">interpreter._</span>

  <span class="k">for</span> <span class="o">{</span>
    <span class="n">dateOfBirth</span> <span class="k">&lt;-</span> <span class="n">ask</span><span class="o">[</span><span class="kt">LocalDate</span><span class="o">](</span><span class="s">"date-of-birth"</span><span class="o">)</span>
    <span class="n">daysAlive</span> <span class="k">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">toEpochDay</span> <span class="o">-</span> <span class="n">dateOfBirth</span><span class="o">.</span><span class="n">toEpochDay</span>
    <span class="k">_</span>           <span class="k">&lt;-</span> <span class="n">tell</span><span class="o">[</span><span class="kt">Long</span><span class="o">](</span><span class="s">"days-alive"</span><span class="o">,</span> <span class="n">daysAlive</span><span class="o">)</span>
  <span class="o">}</span> <span class="k">yield</span> <span class="n">dateOfBirth</span><span class="o">.</span><span class="n">format</span><span class="o">(</span>
    <span class="nc">DateTimeFormatter</span><span class="o">.</span><span class="n">ofLocalizedDate</span><span class="o">(</span><span class="nc">FormatStyle</span><span class="o">.</span><span class="nc">FULL</span><span class="o">)</span>
  <span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Notice that this is very similar to a tagless final program - except
that we are taking our <code class="highlighter-rouge">TellTypes</code> and our <code class="highlighter-rouge">AskTypes</code> as additional
parameters into our interpreter (telling the interpreter what we
expect it to support), and that the <code class="highlighter-rouge">interpreter.ask</code> method
accepts a type parameter which controls its output type.</p>

<p>We created <code class="highlighter-rouge">TellTypes</code> and <code class="highlighter-rouge">AskTypes</code> to supply them into our
journey. We could have just inlined these types but generally it is
useful to create type aliases as it can help with debugging and makes
your code a bit clearer.</p>

<p>Notice that we are creating a <code class="highlighter-rouge">String</code> type in our journey, but we
don’t need to have this type declared in either <code class="highlighter-rouge">TellTypes</code> or
<code class="highlighter-rouge">AskTypes</code>.</p>

<p>The journey itself defines the user-journey or interaction you wish to
model. It is completely abstract at this point and the interpreter
gets to decide how to represent the questions.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/uniform-scala/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/uniform-scala/js/main.js"></script></body></html>