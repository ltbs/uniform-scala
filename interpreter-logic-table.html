<html><head><title>uniform-scala: Logic Table Interpreter</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Luke Tebbs" /><meta name="description" content="Purely functional user-interaction" /><meta name="og:image" content="/uniform-scala/img/poster.png" /><meta name="og:title" content="uniform-scala: Logic Table Interpreter" /><meta name="og:site_name" content="uniform-scala" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Purely functional user-interaction" /><link rel="icon" type="image/png" href="/uniform-scala/img/favicon.png" /><meta name="twitter:title" content="uniform-scala: Logic Table Interpreter" /><meta name="twitter:image" content="img/poster.png" /><meta name="twitter:description" content="Purely functional user-interaction" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/uniform-scala/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/uniform-scala/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/uniform-scala/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/uniform-scala/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/uniform-scala/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/uniform-scala/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/uniform-scala/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/uniform-scala/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/uniform-scala/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/uniform-scala/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/uniform-scala/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/uniform-scala/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/uniform-scala/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/uniform-scala/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/uniform-scala/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/uniform-scala/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/uniform-scala/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/uniform-scala/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/uniform-scala/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/uniform-scala/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/uniform-scala/highlight/styles/color-brewer.css" /><link rel="stylesheet" href="/uniform-scala/css/style.css" /><link rel="stylesheet" href="/uniform-scala/css/palette.css" /><link rel="stylesheet" href="/uniform-scala/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/uniform-scala/" class="brand"><div class="brand-wrapper"><span>uniform-scala</span></div></a></li> <li><a href="/uniform-scala/index.html" class="">Home</a></li> <li><a href="/uniform-scala/writing-a-program.html" class="">Writing a program</a></li> <li><a href="/uniform-scala/interpreters.html" class="">Interpreters</a> <ul class="sub_section"> <li><a href="/uniform-scala/interpreter-cli.html" class="">CLI Interpreter</a></li> <li><a href="/uniform-scala/interpreter-logic-table.html" class=" active ">Logic Table Interpreter</a></li> <li><a href="/uniform-scala/interpreter-play.html" class="">Play Framework Interpreter</a></li> <li><a href="/uniform-scala/interpreter-static-site.html" class="">Static Site interpreter</a></li> <li><a href="/uniform-scala/interpreter-selenium.html" class="">Selenium Interpreter</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('uniform-scala Purely functional user-interaction');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('uniform-scala Purely functional user-interaction');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="ltbs" data-github-repo="uniform-scala"><div class="content-wrapper"><section><h1 id="logic-table-interpreter">Logic Table Interpreter</h1>

<p>The logic table interpreter is another very simple interpreter.</p>

<p>Put simply if given a series of values for the questions a user would
be asked it shows the interactions the user would experience and the
final output of the program upon completion.</p>

<p>Despite being simple the logic table interpreter is however quite
useful as can be readily hooked into unit tests or converted into a
spreadsheet to be shown to stakeholders or Business Analysts.</p>

<h2 id="starting-with-a-program">Starting with a program</h2>

<p>For this example we will include a slightly more complex program in
order to test the logic -</p>

<div class="language-scala highlighter-rouge"><pre class="codehilite"><code><span class="k">import</span> <span class="nn">org.atnos.eff._</span>
<span class="k">import</span> <span class="nn">ltbs.uniform._</span>
<span class="k">import</span> <span class="nn">cats.implicits._</span>

<span class="k">type</span> <span class="kt">Money</span> <span class="o">=</span> <span class="nc">Int</span> 

<span class="k">def</span> <span class="n">greasySpoon</span><span class="o">[</span><span class="kt">S</span> <span class="kt">:</span> <span class="k">_</span><span class="kt">uniform</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">?</span><span class="o">]</span> <span class="kt">:</span> <span class="k">_</span><span class="kt">uniform</span><span class="o">[</span><span class="kt">Boolean</span>,<span class="kt">?</span><span class="o">]]</span> <span class="k">:</span> <span class="kt">Eff</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Money</span><span class="o">]</span> <span class="k">=</span> <span class="k">for</span> <span class="o">{</span>
  <span class="n">age</span>   <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Int</span><span class="o">](</span><span class="s">"age"</span><span class="o">)</span>
  <span class="n">food</span>  <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Boolean</span><span class="o">](</span><span class="s">"wantFood"</span><span class="o">)</span>
  <span class="n">tea</span>   <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Boolean</span><span class="o">](</span><span class="s">"wantTea"</span><span class="o">)</span>  
  <span class="n">baconCost</span> <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Int</span><span class="o">](</span><span class="s">"bacon"</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">12</span><span class="o">)</span> <span class="n">emptyUnless</span> <span class="n">food</span>
  <span class="n">eggsCost</span>  <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Int</span><span class="o">](</span><span class="s">"eggs"</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">24</span><span class="o">)</span> <span class="n">emptyUnless</span> <span class="n">food</span>
  <span class="n">foodCost</span> <span class="k">=</span> <span class="n">baconCost</span> <span class="o">+</span> <span class="n">eggsCost</span>
  <span class="n">teaCost</span> <span class="k">&lt;-</span> <span class="n">uask</span><span class="o">[</span><span class="kt">S</span>,<span class="kt">Int</span><span class="o">](</span><span class="s">"sugar"</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="mi">50</span><span class="o">)</span> <span class="n">emptyUnless</span> <span class="n">tea</span>
  <span class="n">youngDiscount</span> <span class="k">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="o">)</span>
                    <span class="n">teaCost</span> <span class="o">/</span> <span class="mi">10</span>
		  <span class="k">else</span> <span class="mi">0</span>
  <span class="n">oldDiscount</span>   <span class="k">=</span> <span class="k">if</span> <span class="o">(</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="o">)</span>
                    <span class="o">(</span><span class="n">teaCost</span> <span class="o">+</span> <span class="n">foodCost</span><span class="o">)</span> <span class="o">*</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="n">min</span><span class="o">(</span><span class="n">age</span> <span class="o">-</span> <span class="mi">60</span><span class="o">,</span><span class="mi">25</span><span class="o">)</span> <span class="o">/</span> <span class="mi">100</span><span class="o">)</span>
		  <span class="k">else</span> <span class="mi">0</span>
<span class="o">}</span> <span class="k">yield</span> <span class="o">(</span><span class="n">foodCost</span> <span class="o">+</span> <span class="n">teaCost</span> <span class="o">+</span> <span class="n">youngDiscount</span> <span class="o">+</span> <span class="n">oldDiscount</span><span class="o">)</span>
</code></pre></div>

<p>So we have a program for a fastfood restaurant. The user is first
asked for their age, then if they want food and if they want tea. They
are charged 12 pence per slice of bacon (or 12 pounds if you are in
Shoreditch - Iâ€™ll leave it to the user to determine the currency), 24p
per egg, 50p for a mug of tea plus 10p per dose of sugar. Finally
young customers get 10% off tea and older customers get 1% off both
food and drink per year over 60 up to a maximum of 25%.</p>

<p>We want to test -</p>

<ol>
  <li>The user is asked the correct questions (only being asked
  about food if we say we want food, for example)</li>
  <li>The calculations are correct</li>
</ol>

<p>Obviously this is rather silly - normally we would extract the
calculation logic out into a function, but for the sake of
illustrating the testing we will leave the financial code tangled into
our user-interaction program.</p>

<h2 id="setup">Setup</h2>

<p>We need to add an extra import to include the new interpreter -</p>

<div class="highlighter-rouge"><pre class="codehilite"><code>libraryDependencies +=
  "com.luketebbs.uniform" % "interpreter-logictable" %% "[VERSION]"
</code></pre></div>

<p>And we need to import</p>

<div class="language-scala highlighter-rouge"><pre class="codehilite"><code><span class="k">import</span> <span class="nn">LogicTableInterpreter._</span>
</code></pre></div>

<p>And we need to define a stack for our program. The logic table
interpreter needs a few monads in its stack, but it defines its own
type for the stack. We need to define the stack for our program and
join it to the stack needed by the logic table interpreter -</p>

<div class="language-scala highlighter-rouge"><pre class="codehilite"><code><span class="k">type</span> <span class="kt">GreasyStack</span> <span class="o">=</span> <span class="nc">Fx2</span><span class="o">[</span><span class="kt">UniformAsk</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">?</span><span class="o">]</span>, <span class="kt">UniformAsk</span><span class="o">[</span><span class="kt">Boolean</span>,<span class="kt">?</span><span class="o">]]</span>
<span class="k">type</span> <span class="kt">FullStack</span> <span class="o">=</span> <span class="nc">FxAppend</span><span class="o">[</span><span class="kt">GreasyStack</span>, <span class="kt">LogicTableStack</span><span class="o">]</span>
</code></pre></div>

<h2 id="providing-sample-input">Providing sample input</h2>

<div class="language-scala highlighter-rouge"><pre class="codehilite"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">import</span> <span class="nn">org.atnos.eff.syntax.all._</span>
<span class="k">import</span> <span class="nn">org.atnos.eff.syntax.all._</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">output</span> <span class="k">=</span> <span class="n">greasySpoon</span><span class="o">[</span><span class="kt">FullStack</span><span class="o">].</span>
     <span class="o">|</span>   <span class="n">giveExamples</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="kc">true</span><span class="o">,</span><span class="kc">false</span><span class="o">)).</span>
     <span class="o">|</span>   <span class="n">giveExamples</span><span class="o">{</span>
     <span class="o">|</span>     <span class="k">case</span> <span class="s">"age"</span> <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">10</span><span class="o">,</span><span class="mi">50</span><span class="o">,</span><span class="mi">100</span><span class="o">)</span>
     <span class="o">|</span>     <span class="k">case</span> <span class="k">_</span>     <span class="k">=&gt;</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">)</span>
     <span class="o">|</span>   <span class="o">}.</span>
     <span class="o">|</span>   <span class="n">runEither</span><span class="o">.</span><span class="n">runWriter</span><span class="o">.</span><span class="n">runList</span><span class="o">.</span><span class="n">run</span>
<span class="n">output</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">scala.util.Either</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">Int</span><span class="o">]</span>, <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">])]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="nc">Right</span><span class="o">(</span><span class="mi">102</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">1</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">113</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">2</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">124</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">3</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">126</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">2</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">1</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">137</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">2</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">2</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">148</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">2</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">3</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">150</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">3</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">1</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">161</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">bacon</span><span class="k">:</span><span class="err">1</span><span class="o">,</span> <span class="n">eggs</span><span class="k">:</span><span class="err">3</span><span class="o">,</span> <span class="n">sugar</span><span class="k">:</span><span class="err">2</span><span class="o">)),</span> <span class="o">(</span><span class="nc">Right</span><span class="o">(</span><span class="mi">172</span><span class="o">),</span><span class="nc">List</span><span class="o">(</span><span class="n">age</span><span class="k">:</span><span class="err">10</span><span class="o">,</span> <span class="n">wantFood</span><span class="k">:</span><span class="kt">true</span><span class="o">,</span> <span class="n">wantTea</span><span class="k">:</span><span class="kt">...</span>
</code></pre></div>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/uniform-scala/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script>((window.gitter = {}).chat = {}).options = {
room: 'ltbs/uniform-scala'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/uniform-scala/js/main.js"></script></body></html>