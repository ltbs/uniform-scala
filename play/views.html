<html><head><title>uniform-scala: Views</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Luke Tebbs" /><meta name="description" content="Purely functional user-interaction" /><meta name="og:image" content="/uniform-scala/img/poster.png" /><meta name="image" property="og:image" content="/uniform-scala/img/poster.png" /><meta name="og:title" content="uniform-scala: Views" /><meta name="title" property="og:title" content="uniform-scala: Views" /><meta name="og:site_name" content="uniform-scala" /><meta name="og:url" content="https://ltbs.github.io/uniform-scala/" /><meta name="og:type" content="website" /><meta name="og:description" content="Purely functional user-interaction" /><link rel="icon" type="image/png" href="/uniform-scala/img/favicon.png" /><meta name="twitter:title" content="uniform-scala: Views" /><meta name="twitter:image" content="/uniform-scala/img/poster.png" /><meta name="twitter:description" content="Purely functional user-interaction" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/uniform-scala/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/uniform-scala/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/uniform-scala/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/uniform-scala/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/uniform-scala/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/uniform-scala/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/uniform-scala/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/uniform-scala/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/uniform-scala/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/uniform-scala/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/uniform-scala/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/uniform-scala/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/uniform-scala/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/uniform-scala/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/uniform-scala/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/uniform-scala/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/uniform-scala/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/uniform-scala/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/uniform-scala/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/uniform-scala/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/uniform-scala/highlight/styles/color-brewer.css" /><link rel="stylesheet" href="/uniform-scala/css/style.css" /><link rel="stylesheet" href="/uniform-scala/css/palette.css" /><link rel="stylesheet" href="/uniform-scala/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/uniform-scala/" class="brand"><div class="brand-wrapper"><span>uniform-scala</span></div></a></li> <li><a href="/uniform-scala/index.html" class="">Home</a></li> <li><a href="/uniform-scala/setup.html" class="">Setup</a></li> <li><a href="/uniform-scala/core/basic-program.html" class="">Writing a journey</a> <ul class="sub_section"> <li><a href="/uniform-scala/core/tells.html" class="">Telling</a></li> <li><a href="/uniform-scala/core/asks.html" class="">Asking</a></li> <li><a href="/uniform-scala/core/interacts.html" class="">Interacting</a></li> <li><a href="/uniform-scala/core/validation.html" class="">Validation</a></li> <li><a href="/uniform-scala/core/branching.html" class="">Branching</a></li> <li><a href="/uniform-scala/core/remote-calls.html" class="">Remote Calls</a></li></ul></li> <li><a href="/uniform-scala/play/index.html" class="">Play Framework Interpreter</a> <ul class="sub_section"> <li><a href="/uniform-scala/play/controllers.html" class="">Controllers</a></li> <li><a href="/uniform-scala/play/web-monad.html" class="">WebMonad</a></li> <li><a href="/uniform-scala/play/internationalisation.html" class="">Internationalisation</a></li> <li><a href="/uniform-scala/play/listing-pages.html" class="">Listing Pages</a></li> <li><a href="/uniform-scala/play/remote-calls.html" class="">Memoisation</a></li></ul></li> <li><a href="/uniform-scala/interpreters.html" class="">Other Interpreters</a> <ul class="sub_section"> <li><a href="/uniform-scala/other/interpreter-cli.html" class="">CLI Interpreter</a></li> <li><a href="/uniform-scala/other/interpreter-logic-table.html" class="">Logic Table Interpreter</a></li> <li><a href="/uniform-scala/interpreter-static-site.html" class="">Static Site interpreter</a></li> <li><a href="/uniform-scala/interpreter-selenium.html" class="">Selenium Interpreter</a></li></ul></li> <li><a href="/uniform-scala/core/advanced.html" class="">Advanced Options</a> <ul class="sub_section"> <li><a href="/uniform-scala/core/writing-interpreters.html" class="">Writing Interpreters</a></li></ul></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/ltbs/uniform-scala"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('uniform-scala Purely functional user-interaction');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('uniform-scala Purely functional user-interaction');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="ltbs" data-github-repo="uniform-scala"><div class="content-wrapper"><section><h1 id="views">Views</h1>

<h2 id="different-view-types">Different View Types</h2>

<p>Uniform is agnostic about how views are constructed. In the examples
here we have used twirl Html, but you can use any representation you
wish, as long as it is both <code class="highlighter-rouge">Writeable</code> and a <code class="highlighter-rouge">Monoid</code>.</p>

<p>If you wanted to use scalatags, for example, you could do something
like this -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalatags.Text.all._</span>
<span class="k">import</span> <span class="nn">play.api.http.</span><span class="o">{</span><span class="nc">Writeable</span><span class="o">,</span> <span class="nc">ContentTypeOf</span><span class="o">,</span> <span class="nc">ContentTypes</span><span class="o">}</span>
<span class="k">import</span> <span class="nn">play.api.mvc.Codec</span>
<span class="k">import</span> <span class="nn">cats.Monoid</span>
<span class="k">import</span> <span class="nn">cats.implicits._</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">fragContentType</span><span class="k">:</span> <span class="kt">ContentTypeOf</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">ContentTypeOf</span><span class="o">[</span><span class="kt">Frag</span><span class="o">](</span><span class="nc">Some</span><span class="o">(</span><span class="nc">ContentTypes</span><span class="o">.</span><span class="nc">HTML</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">implicit</span> <span class="k">def</span> <span class="n">fragWriteable</span><span class="o">(</span><span class="k">implicit</span> <span class="n">codec</span><span class="k">:</span> <span class="kt">Codec</span><span class="o">)</span><span class="k">:</span> <span class="kt">Writeable</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="nc">Writeable</span><span class="o">(</span><span class="n">frag</span> <span class="k">=&gt;</span> <span class="n">codec</span><span class="o">.</span><span class="n">encode</span><span class="o">(</span><span class="s">"&lt;!DOCTYPE html&gt;\n"</span> <span class="o">+</span> <span class="n">frag</span><span class="o">.</span><span class="n">render</span><span class="o">))</span>
<span class="o">}</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">fragMonoid</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Monoid</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span> <span class="o">{</span>
    <span class="k">def</span> <span class="n">empty</span><span class="k">:</span> <span class="kt">Frag</span> <span class="o">=</span> <span class="nc">RawFrag</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>
    <span class="k">def</span> <span class="n">combine</span><span class="o">(</span><span class="n">a</span><span class="k">:</span> <span class="kt">Frag</span><span class="o">,</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Frag</span><span class="o">)</span><span class="k">:</span> <span class="kt">Frag</span> <span class="o">=</span> <span class="nc">RawFrag</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="n">render</span> <span class="o">+</span> <span class="n">b</span><span class="o">.</span><span class="n">render</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="how-fields-are-rendered-and-encoded">How fields are rendered and encoded</h2>

<p>Views for compound types are produced using typeclass derivation. For
example, suppose you tell the play interpreter how to construct a view
for a <code class="highlighter-rouge">String</code> field like so -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="k">import</span> <span class="nn">ltbs.uniform._</span><span class="o">,</span> <span class="n">interpreters</span><span class="o">.</span><span class="n">playframework</span><span class="o">.</span><span class="k">_</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="n">scalatagsStringField</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">FormField</span><span class="o">[</span><span class="kt">String</span>,<span class="kt">Frag</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">decode</span><span class="o">(</span><span class="n">out</span><span class="k">:</span> <span class="kt">Input</span><span class="o">)</span><span class="k">:</span> <span class="kt">Either</span><span class="o">[</span><span class="kt">ErrorTree</span>,<span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">root</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">out</span><span class="o">.</span><span class="n">valueAtRoot</span>
      <span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">trim</span><span class="o">.</span><span class="n">nonEmpty</span><span class="o">).</span><span class="n">headOption</span><span class="o">)</span>

    <span class="n">root</span> <span class="k">match</span> <span class="o">{</span>
      <span class="k">case</span> <span class="nc">None</span> <span class="k">=&gt;</span> <span class="nc">Left</span><span class="o">(</span><span class="nc">ErrorMsg</span><span class="o">(</span><span class="s">"required"</span><span class="o">).</span><span class="n">toTree</span><span class="o">)</span>
      <span class="k">case</span> <span class="nc">Some</span><span class="o">(</span><span class="n">data</span><span class="o">)</span> <span class="k">=&gt;</span> <span class="nc">Right</span><span class="o">(</span><span class="n">data</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">encode</span><span class="o">(</span><span class="n">in</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span><span class="k">:</span> <span class="kt">Input</span> <span class="o">=</span>
    <span class="nc">Input</span><span class="o">.</span><span class="n">one</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="n">in</span><span class="o">))</span>

  <span class="k">def</span> <span class="n">render</span><span class="o">(</span>
    <span class="n">key</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">],</span>
    <span class="n">path</span><span class="k">:</span> <span class="kt">Path</span><span class="o">,</span>
    <span class="n">data</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Input</span><span class="o">],</span>
    <span class="n">errors</span><span class="k">:</span> <span class="kt">ErrorTree</span><span class="o">,</span>
    <span class="n">messages</span><span class="k">:</span> <span class="kt">UniformMessages</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span>
  <span class="o">)</span><span class="k">:</span> <span class="kt">Frag</span> <span class="o">=</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">existingValue</span><span class="k">:</span> <span class="kt">String</span> <span class="o">=</span>
      <span class="n">data</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span><span class="o">.</span><span class="n">valueAtRoot</span><span class="o">.</span><span class="n">flatMap</span><span class="o">{</span><span class="k">_</span><span class="o">.</span><span class="n">headOption</span><span class="o">}).</span><span class="n">getOrElse</span><span class="o">(</span><span class="s">""</span><span class="o">)</span>

    <span class="n">input</span><span class="o">(</span><span class="n">`type`</span> <span class="o">:=</span> <span class="s">"text"</span><span class="o">,</span> <span class="n">name</span> <span class="o">:=</span> <span class="n">key</span><span class="o">.</span><span class="n">mkString</span><span class="o">(</span><span class="s">"."</span><span class="o">))</span> <span class="o">{</span> <span class="n">existingValue</span> <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">decode</code> is taking an <code class="highlighter-rouge">Input</code> and
converting it to either a resulting correct <code class="highlighter-rouge">String</code> or an
<code class="highlighter-rouge">ErrorTree</code>. Here the only built-in validation we are doing is to
check the string is non-empty. Normally we would only apply the
validation here to ensure that the data can be mapped to the correct
type (it’s debatable as to if we should even check for non-empty
here). We can always add validation to the actual pages if we want.</p>

<p><code class="highlighter-rouge">encode</code> takes a value and turns it back into an Input. This cannot go
wrong so there is no <code class="highlighter-rouge">ErrorTree</code>.</p>

<p><code class="highlighter-rouge">render</code> is probably the most interesting part here - this emits some
Html (a scalatags <code class="highlighter-rouge">Frag</code> in our instance here).</p>

<p>Note here we’re not doing any special rendering based upon the error
or any field labels.</p>

<p>There is quite a lot going on in this string example. However it’s
easy to produce other field types from this -</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">implicit</span> <span class="k">val</span> <span class="n">scalatagsIntField</span><span class="k">:</span> <span class="kt">FormField</span><span class="o">[</span><span class="kt">Int</span>,<span class="kt">Frag</span><span class="o">]</span> <span class="k">=</span>
  <span class="n">scalatagsStringField</span><span class="o">.</span><span class="n">simap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span>
    <span class="nc">Either</span><span class="o">.</span><span class="n">catchOnly</span><span class="o">[</span><span class="kt">NumberFormatException</span><span class="o">](</span><span class="n">x</span><span class="o">.</span><span class="n">toInt</span><span class="o">)</span>
      <span class="o">.</span><span class="n">leftMap</span><span class="o">(</span><span class="k">_</span> <span class="k">=&gt;</span> <span class="nc">ErrorMsg</span><span class="o">(</span><span class="s">"bad.value"</span><span class="o">).</span><span class="n">toTree</span><span class="o">)</span>
  <span class="o">)(</span><span class="k">_</span><span class="o">.</span><span class="n">toString</span><span class="o">)</span>
</code></pre></div></div>

<p>An <code class="highlighter-rouge">Int</code> field would be almost identical to a <code class="highlighter-rouge">String</code> field - the
presentation should be the same but the <code class="highlighter-rouge">encode</code> method needs to take
an <code class="highlighter-rouge">Int</code> and the <code class="highlighter-rouge">decode</code> method needs to emit an
<code class="highlighter-rouge">Either[ErrorTree,Int]</code>. These methods should be based upon the
ones used for <code class="highlighter-rouge">scalatagsStringField</code> - we still want to check the
field is non-empty before attempting to parse it into an <code class="highlighter-rouge">Int</code> but we
want to append a check and conversion to the <code class="highlighter-rouge">decode</code> method. The
<code class="highlighter-rouge">encode</code> method should still place the value in the correct place but
we want to turn the <code class="highlighter-rouge">Int</code> into a <code class="highlighter-rouge">String</code> <em>beforehand</em>.</p>

<p>The <code class="highlighter-rouge">simap</code> method (named because the transformation is a split
epimorphism) allows us to prepend a method to <code class="highlighter-rouge">encode</code> (<code class="highlighter-rouge">Int =&gt; String</code>
in our case) and append a flatMap transformation to <code class="highlighter-rouge">decode</code> (
<code class="highlighter-rouge">String =&gt; Either[ErrorTree, Int]</code>).</p>

<h2 id="how-views-are-derived">How views are derived</h2>

<p>One of the main advantages of using the Uniform Play Interpreter over
manually crafting journeys is that you can take advantage of the form
inference, that is if you have a case class which is composed of
<code class="highlighter-rouge">String</code>s and <code class="highlighter-rouge">Int</code>s the interpreter can figure out how to display it
and encode it for you.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">case</span> <span class="k">class</span> <span class="nc">Person</span><span class="o">(</span><span class="n">forename</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">surname</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">age</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span>

<span class="k">val</span> <span class="n">luke</span> <span class="k">=</span> <span class="nc">Person</span><span class="o">(</span><span class="s">"Luke"</span><span class="o">,</span> <span class="s">"Tebbs"</span><span class="o">,</span> <span class="mi">38</span><span class="o">)</span>

<span class="c1">// normally we won't need this import when working within a
// controller -
</span><span class="k">object</span> <span class="nc">Inferer</span> <span class="k">extends</span> <span class="n">ltbs</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">web</span><span class="o">.</span><span class="nc">InferFormField</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span> <span class="o">{</span>

  <span class="k">def</span> <span class="n">selectionOfFields</span><span class="o">(</span>
    <span class="n">inner</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">String</span>, <span class="o">(</span><span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span>, <span class="kt">Path</span>, <span class="kt">Option</span><span class="o">[</span><span class="kt">Input</span><span class="o">]</span>, <span class="kt">ErrorTree</span>, <span class="kt">UniformMessages</span><span class="o">[</span><span class="kt">Frag</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="kt">Frag</span><span class="o">)]</span>
  <span class="o">)(</span>
    <span class="n">key</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">String</span><span class="o">],</span>
    <span class="n">path</span><span class="k">:</span> <span class="kt">Path</span><span class="o">,</span>
    <span class="n">values</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Input</span><span class="o">],</span>
    <span class="n">errors</span><span class="k">:</span> <span class="kt">ErrorTree</span><span class="o">,</span>
    <span class="n">messages</span><span class="k">:</span> <span class="kt">UniformMessages</span><span class="o">[</span><span class="kt">Frag</span><span class="o">]</span>
  <span class="o">)</span><span class="k">:</span> <span class="kt">Frag</span> <span class="o">=</span> <span class="o">???</span>

<span class="o">}</span>
<span class="k">import</span> <span class="nn">Inferer._</span>

<span class="n">implicitly</span><span class="o">[</span><span class="kt">FormField</span><span class="o">[</span><span class="kt">Person</span>, <span class="kt">Frag</span><span class="o">]].</span><span class="n">encode</span><span class="o">(</span><span class="n">luke</span><span class="o">)</span>
</code></pre></div></div>

<h2 id="overriding-views-for-a-single-page">Overriding views for a single page</h2>

<h2 id="overriding-views-for-a-whole-journey">Overriding views for a whole journey</h2>

<h2 id="creating-more-complex-actions">Creating more complex actions</h2>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/uniform-scala/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script src="/uniform-scala/js/main.js"></script></body></html>